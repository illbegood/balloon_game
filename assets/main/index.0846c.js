window.__require=function t(e,o,n){function i(s,c){if(!o[s]){if(!e[s]){var a=s.split("/");if(a=a[a.length-1],!e[a]){var l="function"==typeof __require&&__require;if(!c&&l)return l(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+s+"'")}s=a}var p=o[s]={exports:{}};e[s][0].call(p.exports,function(t){return i(e[s][1][t]||t)},p,p.exports,t,e,o,n)}return o[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<n.length;s++)i(n[s]);return i}({Balloon:[function(t,e,o){"use strict";cc._RF.push(e,"d0f03BUfG1OtbPZsQJ23t/5","Balloon");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=r.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pickRadius=0,e.game=null,e.spawn=0,e}return n(e,t),e.prototype.onLoad=function(){this.enabled=!1},e.prototype.init=function(t,e){this.game=t,this.spawn=e,this.enabled=!0},e.prototype.getTouchDistance=function(t){return this.node.position.sub(t).mag()},e.prototype.isTouched=function(t){return this.getTouchDistance(t)<this.pickRadius},e.prototype.onPicked=function(){var t=this.node.getPosition();this.game.gainScore(t),this.game.despawnBalloon(this),this.game.difficulty.increase()&&this.game.levelUp()},e.prototype.update=function(t){this.game.isPlaying&&(this.node.y+=this.game.difficulty.speed*t,this.node.y>=this.game.node.height/2&&this.game.gameOver())},i([c],e.prototype,"pickRadius",void 0),e=i([s],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],Difficulty:[function(t,e,o){"use strict";cc._RF.push(e,"71642vWVkZK94IewgwIEemh","Difficulty"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(t){this.lvl=1,this.maxLvl=1,this.iteration=1,this.maxIteration=5,this.stage=1,this.maxStage=3,this.minSpeed=20,this.speed=this.minSpeed,this.speedLvlCoeff=3,this.speedStageCoeff=5,this.maxLvl=t}return t.prototype.isMaxLevel=function(){return this.lvl==this.maxLvl},t.prototype.increase=function(){var t=!1;return this.iteration++,this.iteration>this.maxIteration&&(this.iteration=1,this.stage++,this.stage>this.maxStage&&this.lvl<this.maxLvl&&(this.stage=1,this.lvl++,t=!0),this.speed=this.minSpeed+this.speedLvlCoeff*(this.lvl-1)+this.speedStageCoeff*(this.stage-1)),console.log({level:this.lvl,stage:this.stage,iteration:this.iteration,speed:this.speed}),t},t}();o.default=n,cc._RF.pop()},{}],Game:[function(t,e,o){"use strict";cc._RF.push(e,"0486fOqHrJN+6c5PQg5FHh9","Game");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(o,"__esModule",{value:!0});var s=r(t("./Difficulty")),c=r(t("./ScoreFX")),a=r(t("./Balloon")),l=cc._decorator,p=l.ccclass,u=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.balloonPrefab=null,e.scoreFXPrefab=null,e.scoreDisplay=null,e.scoreAudio=null,e.levelDisplay=null,e.levelAudio=null,e.startBtnNode=null,e.rankBtnNode=null,e.usernameBox=null,e.gameOverNode=null,e.balloons=null,e.isPlaying=!1,e.balloonPool=null,e.scorePool=null,e.score=0,e.spawns=10,e.spawnDistance=0,e.takenSpawns=null,e.idleSpawns=null,e.difficulty=null,e.baloonRadius=0,e}return n(e,t),e.prototype.onLoad=function(){this.loadUsername(),this.spawnDistance=this.node.width/this.spawns,this.isPlaying=!1,this.balloonPool=new cc.NodePool("Balloon"),this.scorePool=new cc.NodePool("ScoreFX");var t=cc.instantiate(this.balloonPrefab);this.baloonRadius=t.getComponent(a.default).pickRadius,t.destroy()},e.prototype.onStartGame=function(){this.isPlaying=!0;var t=-this.node.width/2+this.baloonRadius,e=(this.node.width-2*this.baloonRadius)/(this.spawns-1);this.balloons=new Array,this.idleSpawns=Array.from({length:this.spawns},function(o,n){return Math.round(t+n*e)}),this.takenSpawns=new Array,this.difficulty=new s.default(this.spawns),this.score=0,this.levelDisplay.string="Level "+this.difficulty.lvl,this.scoreDisplay.string="Score: "+this.score.toString(),this.showMainMenu(!1),this.gameOverNode.active=!1,this.spawnNewBalloon(),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},e.prototype.onTouchBegan=function(t){var e=t.getLocation().sub(cc.v2(cc.winSize.width/2,cc.winSize.height/2)),o=this.balloons.find(function(t){return t.isTouched(e)});return o&&o.onPicked(),!0},e.prototype.spawnNewBalloon=function(){var t=null,e=!0;this.balloonPool.size()>0?t=this.balloonPool.get(this):(t=cc.instantiate(this.balloonPrefab),e=!1),this.node.addChild(t);var o=this.getSpawn();t.setPosition(cc.v2(o,-this.node.height/2));var n=t.getComponent(a.default);n.init(this,o),e||this.balloons.push(n)},e.prototype.despawnBalloon=function(t){this.balloonPool.put(t.node);var e=this.takenSpawns.indexOf(t.spawn),o=this.takenSpawns[e];this.idleSpawns.push(o),this.takenSpawns.splice(e,1),this.spawnNewBalloon()},e.prototype.getSpawn=function(){var t=Math.floor(Math.random()*this.idleSpawns.length),e=this.idleSpawns[t];return this.takenSpawns.push(e),this.idleSpawns.splice(t,1),e},e.prototype.gainScore=function(t){this.score+=1,this.scoreDisplay.string="Score: "+this.score.toString();var e=this.spawnScoreFX();this.node.addChild(e.node),e.node.setPosition(t),e.play(),cc.audioEngine.play(this.scoreAudio,!1,1)},e.prototype.levelUp=function(){this.levelDisplay.string=this.difficulty.isMaxLevel()?"Max Level":"Level "+this.difficulty.lvl,this.spawnNewBalloon(),cc.audioEngine.play(this.levelAudio,!1,1)},e.prototype.spawnScoreFX=function(){var t;return this.scorePool.size()>0?(t=this.scorePool.get()).getComponent(c.default):((t=cc.instantiate(this.scoreFXPrefab).getComponent(c.default)).init(this),t)},e.prototype.despawnScoreFX=function(t){this.scorePool.put(t)},e.prototype.destroyBalloons=function(){this.balloons.forEach(function(t){return t.node.destroy()})},e.prototype.loadUsername=function(){var t=cc.sys.localStorage.getItem("username");null==t?(this.usernameBox.string="player",this.saveUsername()):this.usernameBox.string=t},e.prototype.saveUsername=function(){cc.sys.localStorage.setItem("username",this.usernameBox.string)},e.prototype.gameOver=function(){this.isPlaying&&(this.isPlaying=!1,this.destroyBalloons(),this.updateRankings(),this.showMainMenu(!0),this.gameOverNode.active=!0,this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this))},e.prototype.showMainMenu=function(t){this.startBtnNode.active=t,this.rankBtnNode.active=t,this.usernameBox.node.active=t},e.prototype.showRankings=function(){cc.director.loadScene("rankings")},e.prototype.updateRankings=function(){var t=cc.sys.localStorage.getItem("rankings");t||(t="{}");var e=JSON.parse(t),o=cc.sys.localStorage.getItem("username"),n=e[o];n||(n=0),e[o]=Math.max(this.score,n),cc.sys.localStorage.setItem("rankings",JSON.stringify(e))},i([u({type:cc.Prefab})],e.prototype,"balloonPrefab",void 0),i([u({type:cc.Prefab})],e.prototype,"scoreFXPrefab",void 0),i([u({type:cc.Label})],e.prototype,"scoreDisplay",void 0),i([u({type:cc.AudioClip})],e.prototype,"scoreAudio",void 0),i([u({type:cc.Label})],e.prototype,"levelDisplay",void 0),i([u({type:cc.AudioClip,serializable:!0})],e.prototype,"levelAudio",void 0),i([u({type:cc.Node})],e.prototype,"startBtnNode",void 0),i([u({type:cc.Node})],e.prototype,"rankBtnNode",void 0),i([u({type:cc.EditBox})],e.prototype,"usernameBox",void 0),i([u({type:cc.Node})],e.prototype,"gameOverNode",void 0),e=i([p],e)}(cc.Component);o.default=h,cc._RF.pop()},{"./Balloon":"Balloon","./Difficulty":"Difficulty","./ScoreFX":"ScoreFX"}],Rankings:[function(t,e,o){"use strict";cc._RF.push(e,"7f1e8eMCZlN1rJwq/adOnRR","Rankings");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=r.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.text="hello",e.closeBtnNode=null,e.Content=null,e.entryPrefab=null,e}return n(e,t),e.prototype.onLoad=function(){var t=this,e=JSON.parse(cc.sys.localStorage.getItem("rankings")),o=[];for(var n in e)o.push([n,e[n]]);o.sort(function(t,e){return e[1]-t[1]}),o.forEach(function(e){var o=cc.instantiate(t.entryPrefab);o.getComponent(cc.Label).string=e[0]+" : "+e[1],t.Content.addChild(o,0)})},e.prototype.start=function(){},e.prototype.onClose=function(){cc.director.loadScene("game")},i([c(cc.Label)],e.prototype,"label",void 0),i([c],e.prototype,"text",void 0),i([c({type:cc.Node})],e.prototype,"closeBtnNode",void 0),i([c({type:cc.Node})],e.prototype,"Content",void 0),i([c({type:cc.Prefab})],e.prototype,"entryPrefab",void 0),e=i([s],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],ScoreAnim:[function(t,e,o){"use strict";cc._RF.push(e,"b1f9e88YHdGr7qD17shtr2w","ScoreAnim");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator.ccclass,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scoreFX=null,e}return n(e,t),e.prototype.init=function(t){this.scoreFX=t},e.prototype.hideFX=function(){this.scoreFX.despawn()},e=i([r],e)}(cc.Component);o.default=s,cc._RF.pop()},{}],ScoreFX:[function(t,e,o){"use strict";cc._RF.push(e,"dd18c67pr9OM5wJb/yY6Onf","ScoreFX");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=r.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.anim=null,e.game=null,e}return n(e,t),e.prototype.init=function(t){this.game=t,this.anim.getComponent("ScoreAnim").init(this)},e.prototype.despawn=function(){this.game.despawnScoreFX(this.node)},e.prototype.play=function(){this.anim.play("score_pop")},i([c({type:cc.Animation})],e.prototype,"anim",void 0),e=i([s],e)}(cc.Component);o.default=a,cc._RF.pop()},{}]},{},["Balloon","Difficulty","Game","Rankings","ScoreAnim","ScoreFX"]);